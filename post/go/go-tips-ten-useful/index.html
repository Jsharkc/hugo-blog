<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    
    <meta property="og:site_name" content="Jacobc&#39; Blog">
    <meta property="og:type" content="article">

    
    <meta property="og:image" content="https://jacobc.vercel.app//img/home-bg-swide.jpg">
    <meta property="twitter:image" content="https://jacobc.vercel.app//img/home-bg-swide.jpg" />
    

    
    <meta name="title" content="åæ¡æœ‰ç”¨çš„ GO å°æŠ€å·§" />
    <meta property="og:title" content="åæ¡æœ‰ç”¨çš„ GO å°æŠ€å·§" />
    <meta property="twitter:title" content="åæ¡æœ‰ç”¨çš„ GO å°æŠ€å·§" />
    

    
    <meta name="description" content="åä¸ª golang å°æŠ€å·§">
    <meta property="og:description" content="åä¸ª golang å°æŠ€å·§" />
    <meta property="twitter:description" content="åä¸ª golang å°æŠ€å·§" />
    

    
    <meta property="twitter:card" content="summary" />
    
    

    <meta name="keyword"  content="åˆ˜ä½³æ˜Œ, liujiachang, LiuJiaChang, åˆ˜ä½³æ˜Œçš„ç½‘ç»œæ—¥å¿—, åˆ˜ä½³æ˜Œçš„åšå®¢, LiuJiaChang Blog, åšå®¢, ä¸ªäººç½‘ç«™, äº’è”ç½‘, Web, äº‘åŸç”Ÿ, PaaS, Istio, Kubernetes, å¾®æœåŠ¡, Microservice">
    <link rel="shortcut icon" href="/img/favicon.ico">

    <title>åæ¡æœ‰ç”¨çš„ GO å°æŠ€å·§-åˆ˜ä½³æ˜Œçš„åšå®¢ | LiuJiaChang&#39; Blog</title>

    <link rel="canonical" href="/post/go/go-tips-ten-useful/">

    
    
    
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    
    <link rel="stylesheet" href="/css/hugo-theme-cleanwhite.min.css">

    
    <link rel="stylesheet" href="/css/zanshang.css">

    
    <link href="https://cdn.jsdelivr.net/gh/FortAwesome/Font-Awesome@5.15.1/css/all.css" rel="stylesheet" type="text/css">

    
    

    
    <script src="/js/jquery.min.js"></script>

    
    <script src="/js/bootstrap.min.js"></script>

    
    <script src="/js/hux-blog.min.js"></script>

    
    

</head>




<nav class="navbar navbar-default navbar-custom navbar-fixed-top">

    <div class="container-fluid">
        
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Jacobc&#39; Blog</a>
        </div>

        
        
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">All Posts</a>
                    </li>
                    
                        
                        <li>
                            <a href="/categories/centos7">centos7</a>
                        </li>
                        
                        <li>
                            <a href="/categories/golang">golang</a>
                        </li>
                        
                    
                    
		    
                        <li><a href="/top/archives/">ARCHIVE</a></li>
                    
                        <li><a href="/top/books/">BOOKS</a></li>
                    
                        <li><a href="/top/about/">ABOUT</a></li>
                    

                    
		    <li>
                        <a href="/search"><i class="fa fa-search"></i></a>
		    </li>
                    
                </ul>
            </div>
        </div>
        
    </div>
    
</nav>
<script>
    
    
    
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    $toggle.addEventListener('click', handleMagic)
    function handleMagic(e){
        if ($navbar.className.indexOf('in') > 0) {
        
            $navbar.className = " ";
            
            setTimeout(function(){
                
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        }else{
        
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }
</script>




<style type="text/css">
    header.intro-header {
        background-image: url('/img/home-bg-swide.jpg')
    }
</style>

<header class="intro-header" >

    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <div class="tags">
                        
                        <a class="tag" href="/tags/golang" title="Golang">
                            Golang
                        </a>
                        
                    </div>
                    <h1>åæ¡æœ‰ç”¨çš„ GO å°æŠ€å·§</h1>
                    <h2 class="subheading"></h2>
                    <span class="meta">
                        
                            Posted by 
                            
                                    Jacobc&#39; Blog
                             
                            on 
                            Monday, July 29, 2019
                            
                            
                            
                            
                    </span>
                </div>
            </div>
        </div>
    </div>
</header>




<article>
    <div class="container">
        <div class="row">

            
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container">

                
                <h1 id="åæ¡æœ‰ç”¨çš„-go-æŠ€å·§">åæ¡æœ‰ç”¨çš„ Go æŠ€å·§</h1>
<p>è½¬è‡ª <a href="https://mikespook.com/2014/07/%E5%8D%81%E6%9D%A1%E6%9C%89%E7%94%A8%E7%9A%84-go-%E6%8A%80%E6%9C%AF/">mikespook.com</a></p>
<p>è¿™é‡Œæ˜¯æˆ‘è¿‡å»å‡ å¹´ä¸­ç¼–å†™çš„å¤§é‡ Go ä»£ç çš„ç»éªŒæ€»ç»“è€Œæ¥çš„è‡ªå·±çš„æœ€ä½³å®è·µã€‚æˆ‘ç›¸ä¿¡å®ƒä»¬å…·æœ‰å¼¹æ€§çš„ã€‚è¿™é‡Œçš„å¼¹æ€§æ˜¯æŒ‡ï¼š
æŸä¸ªåº”ç”¨éœ€è¦é€‚é…ä¸€ä¸ªçµæ´»çš„ç¯å¢ƒã€‚ä½ ä¸å¸Œæœ›æ¯è¿‡ 3 åˆ° 4 ä¸ªæœˆå°±ä¸å¾—ä¸å°†å®ƒä»¬å…¨éƒ¨é‡æ„ä¸€éã€‚æ·»åŠ æ–°çš„ç‰¹æ€§åº”å½“å¾ˆå®¹æ˜“ã€‚è®¸å¤šäººå‚ä¸å¼€å‘è¯¥åº”ç”¨ï¼Œå®ƒåº”å½“å¯ä»¥è¢«ç†è§£ï¼Œä¸”ç»´æŠ¤ç®€å•ã€‚è®¸å¤šäººä½¿ç”¨è¯¥åº”ç”¨ï¼Œbug åº”è¯¥å®¹æ˜“è¢«å‘ç°å¹¶ä¸”å¯ä»¥å¿«é€Ÿçš„ä¿®å¤ã€‚æˆ‘ç”¨äº†å¾ˆé•¿çš„æ—¶é—´å­¦åˆ°äº†è¿™äº›äº‹æƒ…ã€‚å…¶ä¸­çš„ä¸€äº›å¾ˆå¾®å°ï¼Œä½†å¯¹äºè®¸å¤šäº‹æƒ…éƒ½ä¼šæœ‰å½±å“ã€‚æ‰€æœ‰è¿™äº›éƒ½ä»…ä»…æ˜¯å»ºè®®ï¼Œå…·ä½“æƒ…å†µå…·ä½“å¯¹å¾…ï¼Œå¹¶ä¸”å¦‚æœæœ‰å¸®åŠ©çš„è¯åŠ¡å¿…å‘Šè¯‰æˆ‘ã€‚éšæ—¶ç•™è¨€:)</p>
<h2 id="1-ä½¿ç”¨å•ä¸€çš„-gopath">1. ä½¿ç”¨å•ä¸€çš„ GOPATH</h2>
<p>å¤šä¸ª GOPATH çš„æƒ…å†µå¹¶ä¸å…·æœ‰å¼¹æ€§ã€‚GOPATH æœ¬èº«å°±æ˜¯é«˜åº¦è‡ªæˆ‘å®Œå¤‡çš„ï¼ˆé€šè¿‡å¯¼å…¥è·¯å¾„ï¼‰ã€‚æœ‰å¤šä¸ª GOPATH ä¼šå¯¼è‡´æŸäº›å‰¯ä½œç”¨ï¼Œä¾‹å¦‚å¯èƒ½ä½¿ç”¨äº†ç»™å®šçš„åº“çš„ä¸åŒçš„ç‰ˆæœ¬ã€‚ä½ å¯èƒ½åœ¨æŸä¸ªåœ°æ–¹å‡çº§äº†å®ƒï¼Œä½†æ˜¯å…¶ä»–åœ°æ–¹å´æ²¡æœ‰å‡çº§ã€‚è€Œä¸”ï¼Œæˆ‘è¿˜æ²¡é‡åˆ°è¿‡ä»»ä½•ä¸€ä¸ªéœ€è¦ä½¿ç”¨å¤šä¸ª GOPATH çš„æƒ…å†µã€‚æ‰€ä»¥åªä½¿ç”¨å•ä¸€çš„ GOPATHï¼Œè¿™ä¼šæå‡ä½  Go çš„å¼€å‘è¿›åº¦ã€‚</p>
<p>è®¸å¤šäººä¸åŒæ„è¿™ä¸€è§‚ç‚¹ï¼Œæ¥ä¸‹æ¥æˆ‘ä¼šåšä¸€äº›æ¾„æ¸…ã€‚åƒ <a href="https://github.com/coreos/etcd">etcd</a> æˆ– <a href="https://camlistore.org/">camlistore</a> è¿™æ ·çš„å¤§é¡¹ç›®ä½¿ç”¨äº†åƒ <a href="https://github.com/tools/godep">godep</a> è¿™æ ·çš„å·¥å…·ï¼Œå°†æ‰€æœ‰ä¾èµ–ä¿å­˜åˆ°æŸä¸ªç›®å½•ä¸­ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™äº›é¡¹ç›®è‡ªèº«æœ‰ä¸€ä¸ªå•ä¸€çš„ GOPATHã€‚å®ƒä»¬åªèƒ½åœ¨è¿™ä¸ªç›®å½•é‡Œæ‰¾åˆ°å¯¹åº”çš„ç‰ˆæœ¬ã€‚é™¤éä½ çš„é¡¹ç›®å¾ˆå¤§å¹¶ä¸”æä¸ºé‡è¦ï¼Œå¦åˆ™ä¸è¦ä¸ºæ¯ä¸ªé¡¹ç›®ä½¿ç”¨ä¸åŒçš„ GOPATHã€‚å¦‚æœä½ è®¤ä¸ºé¡¹ç›®éœ€è¦ä¸€ä¸ªè‡ªå·±çš„ GOPATH ç›®å½•ï¼Œé‚£ä¹ˆå°±åˆ›å»ºå®ƒï¼Œå¦åˆ™ä¸è¦å°è¯•ä½¿ç”¨å¤šä¸ª GOPATHã€‚å®ƒåªä¼šæ‹–æ…¢ä½ çš„è¿›åº¦ã€‚</p>
<h2 id="2-å°†-for-select-å°è£…åˆ°å‡½æ•°ä¸­">2. å°† for-select å°è£…åˆ°å‡½æ•°ä¸­</h2>
<p>å¦‚æœåœ¨æŸä¸ªæ¡ä»¶ä¸‹ï¼Œä½ éœ€è¦ä» for-select ä¸­é€€å‡ºï¼Œå°±éœ€è¦ä½¿ç”¨æ ‡ç­¾ã€‚ä¾‹å¦‚ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">func</span> <span style="color:#50fa7b">main</span>() {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>L:
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">for</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">select</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">case</span> <span style="color:#ff79c6">&lt;-</span>time.<span style="color:#50fa7b">After</span>(time.Second):
</span></span><span style="display:flex;"><span>            fmt.<span style="color:#50fa7b">Println</span>(<span style="color:#f1fa8c">&#34;hello&#34;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">default</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">break</span> L
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    fmt.<span style="color:#50fa7b">Println</span>(<span style="color:#f1fa8c">&#34;ending&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>å¦‚ä½ æ‰€è§ï¼Œéœ€è¦è”åˆ<code>break</code>ä½¿ç”¨æ ‡ç­¾ã€‚è¿™æœ‰å…¶ç”¨é€”ï¼Œä¸è¿‡æˆ‘ä¸å–œæ¬¢ã€‚è¿™ä¸ªä¾‹å­ä¸­çš„ for å¾ªç¯çœ‹èµ·æ¥å¾ˆå°ï¼Œä½†æ˜¯é€šå¸¸å®ƒä»¬ä¼šæ›´å¤§ï¼Œè€Œåˆ¤æ–­<code>break</code>çš„æ¡ä»¶ä¹Ÿæ›´ä¸ºå†—é•¿ã€‚</p>
<p>å¦‚æœéœ€è¦é€€å‡ºå¾ªç¯ï¼Œæˆ‘ä¼šå°† for-select å°è£…åˆ°å‡½æ•°ä¸­ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">func</span> <span style="color:#50fa7b">main</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#50fa7b">foo</span>()
</span></span><span style="display:flex;"><span>    fmt.<span style="color:#50fa7b">Println</span>(<span style="color:#f1fa8c">&#34;ending&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">func</span> <span style="color:#50fa7b">foo</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">for</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">select</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">case</span> <span style="color:#ff79c6">&lt;-</span>time.<span style="color:#50fa7b">After</span>(time.Second):
</span></span><span style="display:flex;"><span>            fmt.<span style="color:#50fa7b">Println</span>(<span style="color:#f1fa8c">&#34;hello&#34;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">default</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">return</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>ä½ è¿˜å¯ä»¥è¿”å›ä¸€ä¸ªé”™è¯¯ï¼ˆæˆ–ä»»ä½•å…¶ä»–å€¼ï¼‰ï¼Œä¹Ÿæ˜¯åŒæ ·æ¼‚äº®çš„ï¼Œåªéœ€è¦ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#6272a4">// é˜»å¡
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span><span style="color:#ff79c6">if</span> err <span style="color:#ff79c6">:=</span> <span style="color:#50fa7b">foo</span>(); err <span style="color:#ff79c6">!=</span> <span style="color:#ff79c6">nil</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4">// å¤„ç† err
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>}
</span></span></code></pre></div><h2 id="3-åœ¨åˆå§‹åŒ–ç»“æ„ä½“æ—¶ä½¿ç”¨å¸¦æœ‰æ ‡ç­¾çš„è¯­æ³•">3. åœ¨åˆå§‹åŒ–ç»“æ„ä½“æ—¶ä½¿ç”¨å¸¦æœ‰æ ‡ç­¾çš„è¯­æ³•</h2>
<p>è¿™æ˜¯ä¸€ä¸ªæ— æ ‡ç­¾è¯­æ³•çš„ä¾‹å­ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">type</span> T <span style="color:#8be9fd;font-style:italic">struct</span> {
</span></span><span style="display:flex;"><span>    Foo <span style="color:#8be9fd">string</span>
</span></span><span style="display:flex;"><span>    Bar <span style="color:#8be9fd">int</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">func</span> <span style="color:#50fa7b">main</span>() {
</span></span><span style="display:flex;"><span>    t <span style="color:#ff79c6">:=</span> T{<span style="color:#f1fa8c">&#34;example&#34;</span>, <span style="color:#bd93f9">123</span>} <span style="color:#6272a4">// æ— æ ‡ç­¾è¯­æ³•
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>    fmt.<span style="color:#50fa7b">Printf</span>(<span style="color:#f1fa8c">&#34;t %+v\n&#34;</span>, t)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>é‚£ä¹ˆå¦‚æœä½ æ·»åŠ ä¸€ä¸ªæ–°çš„å­—æ®µåˆ°<code>T</code>ç»“æ„ä½“ï¼Œä»£ç ä¼šç¼–è¯‘å¤±è´¥ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">type</span> T <span style="color:#8be9fd;font-style:italic">struct</span> {
</span></span><span style="display:flex;"><span>    Foo <span style="color:#8be9fd">string</span>
</span></span><span style="display:flex;"><span>    Bar <span style="color:#8be9fd">int</span>
</span></span><span style="display:flex;"><span>    Qux <span style="color:#8be9fd">string</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">func</span> <span style="color:#50fa7b">main</span>() {
</span></span><span style="display:flex;"><span>    t <span style="color:#ff79c6">:=</span> T{<span style="color:#f1fa8c">&#34;example&#34;</span>, <span style="color:#bd93f9">123</span>} <span style="color:#6272a4">// æ— æ³•ç¼–è¯‘
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>    fmt.<span style="color:#50fa7b">Printf</span>(<span style="color:#f1fa8c">&#34;t %+v\n&#34;</span>, t)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>å¦‚æœä½¿ç”¨äº†æ ‡ç­¾è¯­æ³•ï¼ŒGo çš„å…¼å®¹æ€§è§„åˆ™ï¼ˆ<a href="http://golang.org/doc/go1compat">http://golang.org/doc/go1compat</a>ï¼‰ä¼šå¤„ç†ä»£ç ã€‚ä¾‹å¦‚åœ¨å‘<code>net</code>åŒ…çš„ç±»å‹æ·»åŠ å«åš<code>Zone</code>çš„å­—æ®µï¼Œå‚è§ï¼š<a href="http://golang.org/doc/go1.1#library">http://golang.org/doc/go1.1#library</a>ã€‚å›åˆ°æˆ‘ä»¬çš„ä¾‹å­ï¼Œä½¿ç”¨æ ‡ç­¾è¯­æ³•ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">type</span> T <span style="color:#8be9fd;font-style:italic">struct</span> {
</span></span><span style="display:flex;"><span>    Foo <span style="color:#8be9fd">string</span>
</span></span><span style="display:flex;"><span>    Bar <span style="color:#8be9fd">int</span>
</span></span><span style="display:flex;"><span>    Qux <span style="color:#8be9fd">string</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">func</span> <span style="color:#50fa7b">main</span>() {
</span></span><span style="display:flex;"><span>    t <span style="color:#ff79c6">:=</span> T{Foo: <span style="color:#f1fa8c">&#34;example&#34;</span>, Qux: <span style="color:#bd93f9">123</span>}
</span></span><span style="display:flex;"><span>    fmt.<span style="color:#50fa7b">Printf</span>(<span style="color:#f1fa8c">&#34;t %+v\n&#34;</span>, t)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>è¿™ä¸ªç¼–è¯‘èµ·æ¥æ²¡é—®é¢˜ï¼Œè€Œä¸”å¼¹æ€§ä¹Ÿå¥½ã€‚ä¸è®ºä½ å¦‚ä½•æ·»åŠ å…¶ä»–å­—æ®µåˆ°<code>T</code>ç»“æ„ä½“ã€‚ä½ çš„ä»£ç æ€»æ˜¯èƒ½ç¼–è¯‘ï¼Œå¹¶ä¸”åœ¨ä»¥åçš„ Go çš„ç‰ˆæœ¬ä¹Ÿå¯ä»¥ä¿è¯è¿™ä¸€ç‚¹ã€‚åªè¦åœ¨ä»£ç é›†ä¸­æ‰§è¡Œ<code>go vet</code>ï¼Œå°±å¯ä»¥å‘ç°æ‰€æœ‰çš„æ— æ ‡ç­¾çš„è¯­æ³•ã€‚</p>
<h2 id="4-å°†ç»“æ„ä½“çš„åˆå§‹åŒ–æ‹†åˆ†åˆ°å¤šè¡Œ">4. å°†ç»“æ„ä½“çš„åˆå§‹åŒ–æ‹†åˆ†åˆ°å¤šè¡Œ</h2>
<p>å¦‚æœæœ‰ä¸¤ä¸ªä»¥ä¸Šçš„å­—æ®µï¼Œé‚£ä¹ˆå°±ç”¨å¤šè¡Œã€‚å®ƒä¼šè®©ä½ çš„ä»£ç æ›´åŠ å®¹æ˜“é˜…è¯»ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸è¦ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span>T{Foo: <span style="color:#f1fa8c">&#34;example&#34;</span>, Bar:someLongVariable, Qux:anotherLongVariable, B: forgetToAddThisToo}
</span></span></code></pre></div><p>è€Œæ˜¯ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span>T{
</span></span><span style="display:flex;"><span>    Foo: <span style="color:#f1fa8c">&#34;example&#34;</span>,
</span></span><span style="display:flex;"><span>    Bar: someLongVariable,
</span></span><span style="display:flex;"><span>    Qux: anotherLongVariable,
</span></span><span style="display:flex;"><span>    B: forgetToAddThisToo,
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>è¿™æœ‰è®¸å¤šå¥½å¤„ï¼Œé¦–å…ˆå®ƒå®¹æ˜“é˜…è¯»ï¼Œå…¶æ¬¡å®ƒä½¿å¾—å…è®¸æˆ–å±è”½å­—æ®µåˆå§‹åŒ–å˜å¾—å®¹æ˜“ï¼ˆåªè¦æ³¨é‡Šæˆ–åˆ é™¤å®ƒä»¬ï¼‰ï¼Œæœ€åæ·»åŠ å…¶ä»–å­—æ®µä¹Ÿæ›´å®¹æ˜“ï¼ˆåªè¦æ·»åŠ ä¸€è¡Œï¼‰ã€‚</p>
<h2 id="5-ä¸ºæ•´æ•°å¸¸é‡æ·»åŠ -string-æ–¹æ³•">5. ä¸ºæ•´æ•°å¸¸é‡æ·»åŠ  String() æ–¹æ³•</h2>
<p>å¦‚æœä½ åˆ©ç”¨ iota æ¥ä½¿ç”¨è‡ªå®šä¹‰çš„æ•´æ•°æšä¸¾ç±»å‹ï¼ŒåŠ¡å¿…è¦ä¸ºå…¶æ·»åŠ  String() æ–¹æ³•ã€‚ä¾‹å¦‚ï¼Œåƒè¿™æ ·ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">type</span> State <span style="color:#8be9fd">int</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">const</span> (
</span></span><span style="display:flex;"><span>    Running State = <span style="color:#ff79c6">iota</span> 
</span></span><span style="display:flex;"><span>    Stopped
</span></span><span style="display:flex;"><span>    Rebooting
</span></span><span style="display:flex;"><span>    Terminated
</span></span><span style="display:flex;"><span>)
</span></span></code></pre></div><p>å¦‚æœä½ åˆ›å»ºäº†è¿™ä¸ªç±»å‹çš„ä¸€ä¸ªå˜é‡ï¼Œç„¶åè¾“å‡ºï¼Œä¼šå¾—åˆ°ä¸€ä¸ªæ•´æ•°ï¼ˆ<a href="http://play.golang.org/p/V5VVFB05HB">http://play.golang.org/p/V5VVFB05HB</a>ï¼‰ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">func</span> <span style="color:#50fa7b">main</span>() {
</span></span><span style="display:flex;"><span>    state <span style="color:#ff79c6">:=</span> Running
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4">// print: &#34;state 0&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>    fmt.<span style="color:#50fa7b">Println</span>(<span style="color:#f1fa8c">&#34;state &#34;</span>, state)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>é™¤éä½ å›é¡¾å¸¸é‡å®šä¹‰ï¼Œå¦åˆ™è¿™é‡Œçš„<code>0</code>çœ‹èµ·æ¥æ¯«æ— æ„ä¹‰ã€‚åªéœ€è¦ä¸º<code>State</code>ç±»å‹æ·»åŠ <code>String()</code>æ–¹æ³•å°±å¯ä»¥ä¿®å¤è¿™ä¸ªé—®é¢˜ï¼ˆ<a href="http://play.golang.org/p/ewMKl6K302">http://play.golang.org/p/ewMKl6K302</a>ï¼‰ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">func</span> (s State) <span style="color:#50fa7b">String</span>() <span style="color:#8be9fd">string</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">switch</span> s {
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">case</span> Running:
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">return</span> <span style="color:#f1fa8c">&#34;Running&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">case</span> Stopped:
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">return</span> <span style="color:#f1fa8c">&#34;Stopped&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">case</span> Rebooting:
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">return</span> <span style="color:#f1fa8c">&#34;Rebooting&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">case</span> Terminated:
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">return</span> <span style="color:#f1fa8c">&#34;Terminated&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">default</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">return</span> <span style="color:#f1fa8c">&#34;Unknown&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>æ–°çš„è¾“å‡ºæ˜¯ï¼š<code>state: Running</code>ã€‚æ˜¾ç„¶ç°åœ¨çœ‹èµ·æ¥å¯è¯»æ€§å¥½äº†å¾ˆå¤šã€‚åœ¨ä½ è°ƒè¯•ç¨‹åºçš„æ—¶å€™ï¼Œè¿™ä¼šå¸¦æ¥æ›´å¤šçš„ä¾¿åˆ©ã€‚åŒæ—¶è¿˜å¯ä»¥åœ¨å®ç° MarshalJSON()ã€UnmarshalJSON() è¿™ç±»æ–¹æ³•çš„æ—¶å€™ä½¿ç”¨åŒæ ·çš„æ‰‹æ®µã€‚</p>
<h2 id="6-è®©-iota-ä»-a-1-å¼€å§‹å¢é‡">6. è®© iota ä» a +1 å¼€å§‹å¢é‡</h2>
<p>åœ¨å‰é¢çš„ä¾‹å­ä¸­åŒæ—¶ä¹Ÿäº§ç”Ÿäº†ä¸€ä¸ªæˆ‘å·²ç»é‡åˆ°è¿‡è®¸å¤šæ¬¡çš„ bugã€‚å‡è®¾ä½ æœ‰ä¸€ä¸ªæ–°çš„ç»“æ„ä½“ï¼Œæœ‰ä¸€ä¸ª<code>State</code>å­—æ®µï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">type</span> T <span style="color:#8be9fd;font-style:italic">struct</span> {
</span></span><span style="display:flex;"><span>    Name  <span style="color:#8be9fd">string</span>
</span></span><span style="display:flex;"><span>    Port  <span style="color:#8be9fd">int</span>
</span></span><span style="display:flex;"><span>    State State
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>ç°åœ¨å¦‚æœåŸºäº T åˆ›å»ºä¸€ä¸ªæ–°çš„å˜é‡ï¼Œç„¶åè¾“å‡ºï¼Œä½ ä¼šå¾—åˆ°å¥‡æ€ªçš„ç»“æœï¼ˆ<a href="http://play.golang.org/p/LPG2RF3y39">http://play.golang.org/p/LPG2RF3y39</a>ï¼‰ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">func</span> <span style="color:#50fa7b">main</span>() {
</span></span><span style="display:flex;"><span>    t <span style="color:#ff79c6">:=</span> T{Name: <span style="color:#f1fa8c">&#34;example&#34;</span>, Port: <span style="color:#bd93f9">6666</span>}
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4">// prints: &#34;t {Name:example Port:6666 State:Running}&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>    fmt.<span style="color:#50fa7b">Printf</span>(<span style="color:#f1fa8c">&#34;t %+v\n&#34;</span>, t)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>çœ‹åˆ° bug äº†å—ï¼Ÿ<code>State</code>å­—æ®µæ²¡æœ‰åˆå§‹åŒ–ï¼ŒGo é»˜è®¤ä½¿ç”¨å¯¹åº”ç±»å‹çš„é›¶å€¼è¿›è¡Œå¡«å……ã€‚ç”±äº<code>State</code>æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œé›¶å€¼ä¹Ÿå°±æ˜¯<code>0</code>ï¼Œä½†åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­å®ƒè¡¨ç¤º<code>Running</code>ã€‚</p>
<p>é‚£ä¹ˆå¦‚ä½•çŸ¥é“ State è¢«åˆå§‹åŒ–äº†ï¼Ÿè¿˜æ˜¯å®ƒçœŸå¾—æ˜¯åœ¨<code>Running</code>æ¨¡å¼ï¼Ÿæ²¡æœ‰åŠæ³•åŒºåˆ†å®ƒä»¬ï¼Œé‚£ä¹ˆè¿™å°±ä¼šäº§ç”ŸæœªçŸ¥çš„ã€ä¸å¯é¢„æµ‹çš„ bugã€‚ä¸è¿‡ï¼Œä¿®å¤è¿™ä¸ªå¾ˆå®¹æ˜“ï¼Œåªè¦è®© iota ä» +1 å¼€å§‹ï¼ˆ<a href="http://play.golang.org/p/VyAq-3OItv">http://play.golang.org/p/VyAq-3OItv</a>ï¼‰ï¼š</p>
<p>ç°åœ¨<code>t</code>å˜é‡å°†é»˜è®¤è¾“å‡º<code>Unknown</code>ï¼Œä¸æ˜¯å—ï¼Ÿ ğŸ™‚ ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">func</span> <span style="color:#50fa7b">main</span>() {
</span></span><span style="display:flex;"><span>    t <span style="color:#ff79c6">:=</span> T{Name: <span style="color:#f1fa8c">&#34;example&#34;</span>, Port: <span style="color:#bd93f9">6666</span>}
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4">// è¾“å‡ºï¼š &#34;t {Name:example Port:6666 State:Unknown}&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>    fmt.<span style="color:#50fa7b">Printf</span>(<span style="color:#f1fa8c">&#34;t %+v\n&#34;</span>, t)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>ä¸è¿‡è®© iota ä»é›¶å€¼å¼€å§‹ä¹Ÿæ˜¯ä¸€ç§è§£å†³åŠæ³•ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥å¼•å…¥ä¸€ä¸ªæ–°çš„çŠ¶æ€å«åš<code>Unknown</code>ï¼Œå°†å…¶ä¿®æ”¹ä¸ºï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">const</span> (
</span></span><span style="display:flex;"><span>    Unknown State = <span style="color:#ff79c6">iota</span>
</span></span><span style="display:flex;"><span>    Running
</span></span><span style="display:flex;"><span>    Stopped
</span></span><span style="display:flex;"><span>    Rebooting
</span></span><span style="display:flex;"><span>    Terminated
</span></span><span style="display:flex;"><span>)
</span></span></code></pre></div><h2 id="7-è¿”å›å‡½æ•°è°ƒç”¨">7. è¿”å›å‡½æ•°è°ƒç”¨</h2>
<p>æˆ‘å·²ç»çœ‹è¿‡å¾ˆå¤šä»£ç ä¾‹å¦‚ï¼ˆ<a href="http://play.golang.org/p/8Rz1EJwFTZ">http://play.golang.org/p/8Rz1EJwFTZ</a>ï¼‰ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">func</span> <span style="color:#50fa7b">bar</span>() (<span style="color:#8be9fd">string</span>, <span style="color:#8be9fd">error</span>) {
</span></span><span style="display:flex;"><span>    v, err <span style="color:#ff79c6">:=</span> <span style="color:#50fa7b">foo</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">if</span> err <span style="color:#ff79c6">!=</span> <span style="color:#ff79c6">nil</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">return</span> <span style="color:#f1fa8c">&#34;&#34;</span>, err
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">return</span> v, <span style="color:#ff79c6">nil</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>ç„¶è€Œï¼Œä½ åªéœ€è¦ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">func</span> <span style="color:#50fa7b">bar</span>() (<span style="color:#8be9fd">string</span>, <span style="color:#8be9fd">error</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">return</span> <span style="color:#50fa7b">foo</span>()
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>æ›´ç®€å•ä¹Ÿæ›´å®¹æ˜“é˜…è¯»ï¼ˆå½“ç„¶ï¼Œé™¤éä½ è¦å¯¹æŸäº›å†…éƒ¨çš„å€¼åšä¸€äº›è®°å½•ï¼‰ã€‚</p>
<h2 id="8-æŠŠ-slicemap-ç­‰å®šä¹‰ä¸ºè‡ªå®šä¹‰ç±»å‹">8. æŠŠ sliceã€map ç­‰å®šä¹‰ä¸ºè‡ªå®šä¹‰ç±»å‹</h2>
<p>å°† slice æˆ– map å®šä¹‰æˆè‡ªå®šä¹‰ç±»å‹å¯ä»¥è®©ä»£ç ç»´æŠ¤èµ·æ¥æ›´åŠ å®¹æ˜“ã€‚å‡è®¾æœ‰ä¸€ä¸ª<code>Server</code>ç±»å‹å’Œä¸€ä¸ªè¿”å›æœåŠ¡å™¨åˆ—è¡¨çš„å‡½æ•°ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">type</span> Server <span style="color:#8be9fd;font-style:italic">struct</span> {
</span></span><span style="display:flex;"><span>    Name <span style="color:#8be9fd">string</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">func</span> <span style="color:#50fa7b">ListServers</span>() []Server {
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">return</span> []Server{
</span></span><span style="display:flex;"><span>        {Name: <span style="color:#f1fa8c">&#34;Server1&#34;</span>},
</span></span><span style="display:flex;"><span>        {Name: <span style="color:#f1fa8c">&#34;Server2&#34;</span>},
</span></span><span style="display:flex;"><span>        {Name: <span style="color:#f1fa8c">&#34;Foo1&#34;</span>},
</span></span><span style="display:flex;"><span>        {Name: <span style="color:#f1fa8c">&#34;Foo2&#34;</span>},
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>ç°åœ¨å‡è®¾éœ€è¦è·å–æŸäº›ç‰¹å®šåå­—çš„æœåŠ¡å™¨ã€‚éœ€è¦å¯¹ ListServers() åšä¸€äº›æ”¹åŠ¨ï¼Œå¢åŠ ç­›é€‰æ¡ä»¶ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#6272a4">// ListServers è¿”å›æœåŠ¡å™¨åˆ—è¡¨ã€‚åªä¼šè¿”å›åŒ…å« name çš„æœåŠ¡å™¨ã€‚ç©ºçš„ name å°†ä¼šè¿”å›æ‰€æœ‰æœåŠ¡å™¨ã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span><span style="color:#8be9fd;font-style:italic">func</span> <span style="color:#50fa7b">ListServers</span>(name <span style="color:#8be9fd">string</span>) []Server {
</span></span><span style="display:flex;"><span>    servers <span style="color:#ff79c6">:=</span> []Server{
</span></span><span style="display:flex;"><span>        {Name: <span style="color:#f1fa8c">&#34;Server1&#34;</span>},
</span></span><span style="display:flex;"><span>        {Name: <span style="color:#f1fa8c">&#34;Server2&#34;</span>},
</span></span><span style="display:flex;"><span>        {Name: <span style="color:#f1fa8c">&#34;Foo1&#34;</span>},
</span></span><span style="display:flex;"><span>        {Name: <span style="color:#f1fa8c">&#34;Foo2&#34;</span>},
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4">// è¿”å›æ‰€æœ‰æœåŠ¡å™¨
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>    <span style="color:#ff79c6">if</span> name <span style="color:#ff79c6">==</span> <span style="color:#f1fa8c">&#34;&#34;</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">return</span> servers
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4">// è¿”å›è¿‡æ»¤åçš„ç»“æœ
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>    filtered <span style="color:#ff79c6">:=</span> <span style="color:#8be9fd;font-style:italic">make</span>([]Server, <span style="color:#bd93f9">0</span>)
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">for</span> _, server <span style="color:#ff79c6">:=</span> <span style="color:#ff79c6">range</span> servers {
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">if</span> strings.<span style="color:#50fa7b">Contains</span>(server.Name, name) {
</span></span><span style="display:flex;"><span>            filtered = <span style="color:#8be9fd;font-style:italic">append</span>(filtered, server)
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">return</span> filtered
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>ç°åœ¨å¯ä»¥ç”¨è¿™ä¸ªæ¥ç­›é€‰æœ‰å­—ç¬¦ä¸²<code>Foo</code>çš„æœåŠ¡å™¨ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">func</span> <span style="color:#50fa7b">main</span>() {
</span></span><span style="display:flex;"><span>    servers <span style="color:#ff79c6">:=</span> <span style="color:#50fa7b">ListServers</span>(<span style="color:#f1fa8c">&#34;Foo&#34;</span>)
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4">// è¾“å‡ºï¼šâ€œservers [{Name:Foo1} {Name:Foo2}]â€
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>    fmt.<span style="color:#50fa7b">Printf</span>(<span style="color:#f1fa8c">&#34;servers %+v\n&#34;</span>, servers)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>æ˜¾ç„¶è¿™ä¸ªå‡½æ•°èƒ½å¤Ÿæ­£å¸¸å·¥ä½œã€‚ä¸è¿‡å®ƒçš„å¼¹æ€§å¹¶ä¸å¥½ã€‚å¦‚æœä½ æƒ³å¯¹æœåŠ¡å™¨é›†åˆå¼•å…¥å…¶ä»–é€»è¾‘çš„è¯ä¼šå¦‚ä½•å‘¢ï¼Ÿä¾‹å¦‚æ£€æŸ¥æ‰€æœ‰æœåŠ¡å™¨çš„çŠ¶æ€ï¼Œä¸ºæ¯ä¸ªæœåŠ¡å™¨åˆ›å»ºä¸€ä¸ªæ•°æ®åº“è®°å½•ï¼Œç”¨å…¶ä»–å­—æ®µè¿›è¡Œç­›é€‰ç­‰ç­‰â€¦â€¦</p>
<p>ç°åœ¨å¼•å…¥ä¸€ä¸ªå«åš<code>Servers</code>çš„æ–°ç±»å‹ï¼Œå¹¶ä¸”ä¿®æ”¹åŸå§‹ç‰ˆæœ¬çš„ ListServers() è¿”å›è¿™ä¸ªæ–°ç±»å‹ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">type</span> Servers []Server
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span><span style="color:#6272a4">// ListServers è¿”å›æœåŠ¡å™¨åˆ—è¡¨
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span><span style="color:#8be9fd;font-style:italic">func</span> <span style="color:#50fa7b">ListServers</span>() Servers {
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">return</span> []Server{
</span></span><span style="display:flex;"><span>        {Name: <span style="color:#f1fa8c">&#34;Server1&#34;</span>},
</span></span><span style="display:flex;"><span>        {Name: <span style="color:#f1fa8c">&#34;Server2&#34;</span>},
</span></span><span style="display:flex;"><span>        {Name: <span style="color:#f1fa8c">&#34;Foo1&#34;</span>},
</span></span><span style="display:flex;"><span>        {Name: <span style="color:#f1fa8c">&#34;Foo2&#34;</span>},
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>ç°åœ¨éœ€è¦åšçš„æ˜¯åªè¦ä¸º<code>Servers</code>ç±»å‹æ·»åŠ ä¸€ä¸ªæ–°çš„<code>Filter()</code>æ–¹æ³•ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#6272a4">// Filter è¿”å›åŒ…å« name çš„æœåŠ¡å™¨ã€‚ç©ºçš„ name å°†ä¼šè¿”å›æ‰€æœ‰æœåŠ¡å™¨ã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span><span style="color:#8be9fd;font-style:italic">func</span> (s Servers) <span style="color:#50fa7b">Filter</span>(name <span style="color:#8be9fd">string</span>) Servers {
</span></span><span style="display:flex;"><span>    filtered <span style="color:#ff79c6">:=</span> <span style="color:#8be9fd;font-style:italic">make</span>(Servers, <span style="color:#bd93f9">0</span>)
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">for</span> _, server <span style="color:#ff79c6">:=</span> <span style="color:#ff79c6">range</span> s {
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">if</span> strings.<span style="color:#50fa7b">Contains</span>(server.Name, name) {
</span></span><span style="display:flex;"><span>            filtered = <span style="color:#8be9fd;font-style:italic">append</span>(filtered, server)
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">return</span> filtered
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>ç°åœ¨å¯ä»¥é’ˆå¯¹å­—ç¬¦ä¸²<code>Foo</code>ç­›é€‰æœåŠ¡å™¨ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">func</span> <span style="color:#50fa7b">main</span>() {
</span></span><span style="display:flex;"><span>    servers <span style="color:#ff79c6">:=</span> <span style="color:#50fa7b">ListServers</span>()
</span></span><span style="display:flex;"><span>    servers = servers.<span style="color:#50fa7b">Filter</span>(<span style="color:#f1fa8c">&#34;Foo&#34;</span>)
</span></span><span style="display:flex;"><span>    fmt.<span style="color:#50fa7b">Printf</span>(<span style="color:#f1fa8c">&#34;servers %+v\n&#34;</span>, servers)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>å“ˆï¼çœ‹åˆ°ä½ çš„ä»£ç æ˜¯å¤šä¹ˆçš„ç®€å•äº†å—ï¼Ÿè¿˜æƒ³å¯¹æœåŠ¡å™¨çš„çŠ¶æ€è¿›è¡Œæ£€æŸ¥ï¼Ÿæˆ–è€…ä¸ºæ¯ä¸ªæœåŠ¡å™¨æ·»åŠ ä¸€æ¡æ•°æ®åº“è®°å½•ï¼Ÿæ²¡é—®é¢˜ï¼Œæ·»åŠ ä»¥ä¸‹æ–°æ–¹æ³•å³å¯ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">func</span> (s Servers) <span style="color:#50fa7b">Check</span>()
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">func</span> (s Servers) <span style="color:#50fa7b">AddRecord</span>()
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">func</span> (s Servers) <span style="color:#50fa7b">Len</span>()
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">...</span>
</span></span></code></pre></div><h2 id="9-withcontext-å°è£…å‡½æ•°">9. withContext å°è£…å‡½æ•°</h2>
<p>æœ‰æ—¶å¯¹äºå‡½æ•°ä¼šæœ‰ä¸€äº›é‡å¤åŠ³åŠ¨ï¼Œä¾‹å¦‚é”/è§£é”ï¼Œåˆå§‹åŒ–ä¸€ä¸ªæ–°çš„å±€éƒ¨ä¸Šä¸‹æ–‡ï¼Œå‡†å¤‡åˆå§‹åŒ–å˜é‡ç­‰ç­‰â€¦â€¦è¿™é‡Œæœ‰ä¸€ä¸ªä¾‹å­ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">func</span> <span style="color:#50fa7b">foo</span>() {
</span></span><span style="display:flex;"><span>    mu.<span style="color:#50fa7b">Lock</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">defer</span> mu.<span style="color:#50fa7b">Unlock</span>()
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4">// foo ç›¸å…³çš„å·¥ä½œ
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>}
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">func</span> <span style="color:#50fa7b">bar</span>() {
</span></span><span style="display:flex;"><span>    mu.<span style="color:#50fa7b">Lock</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">defer</span> mu.<span style="color:#50fa7b">Unlock</span>()
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4">// bar ç›¸å…³çš„å·¥ä½œ
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>}
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">func</span> <span style="color:#50fa7b">qux</span>() {
</span></span><span style="display:flex;"><span>    mu.<span style="color:#50fa7b">Lock</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">defer</span> mu.<span style="color:#50fa7b">Unlock</span>()
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4">// qux ç›¸å…³çš„å·¥ä½œ
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>}
</span></span></code></pre></div><p>å¦‚æœä½ æƒ³è¦ä¿®æ”¹æŸä¸ªå†…å®¹ï¼Œä½ éœ€è¦å¯¹æ‰€æœ‰çš„éƒ½è¿›è¡Œä¿®æ”¹ã€‚å¦‚æœå®ƒæ˜¯ä¸€ä¸ªå¸¸è§çš„ä»»åŠ¡ï¼Œé‚£ä¹ˆæœ€å¥½åˆ›å»ºä¸€ä¸ªå«åš<code>withContext</code>çš„å‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°çš„è¾“å…¥å‚æ•°æ˜¯å¦ä¸€ä¸ªå‡½æ•°ï¼Œå¹¶ç”¨è°ƒç”¨è€…æä¾›çš„ä¸Šä¸‹æ–‡æ¥è°ƒç”¨å®ƒï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">func</span> <span style="color:#50fa7b">withLockContext</span>(fn <span style="color:#8be9fd;font-style:italic">func</span>()) {
</span></span><span style="display:flex;"><span>    mu.Lock
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">defer</span> mu.<span style="color:#50fa7b">Unlock</span>()
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>    <span style="color:#50fa7b">fn</span>()
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>åªéœ€è¦å°†ä¹‹å‰çš„å‡½æ•°ç”¨è¿™ä¸ªè¿›è¡Œå°è£…ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">func</span> <span style="color:#50fa7b">foo</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#50fa7b">withLockContext</span>(<span style="color:#8be9fd;font-style:italic">func</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">// foo ç›¸å…³å·¥ä½œ
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>    })
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">func</span> <span style="color:#50fa7b">bar</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#50fa7b">withLockContext</span>(<span style="color:#8be9fd;font-style:italic">func</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">// bar ç›¸å…³å·¥ä½œ
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>    })
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">func</span> <span style="color:#50fa7b">qux</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#50fa7b">withLockContext</span>(<span style="color:#8be9fd;font-style:italic">func</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">// qux ç›¸å…³å·¥ä½œ
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>    })
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>ä¸è¦å…‰æƒ³ç€åŠ é”çš„æƒ…å½¢ã€‚å¯¹æ­¤æ¥è¯´æœ€å¥½çš„ç”¨ä¾‹æ˜¯æ•°æ®åº“é“¾æ¥ã€‚ç°åœ¨å¯¹ withContext å‡½æ•°ä½œä¸€äº›å°å°çš„æ”¹åŠ¨ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">func</span> <span style="color:#50fa7b">withDBContext</span>(fn <span style="color:#8be9fd;font-style:italic">func</span>(db DB) <span style="color:#8be9fd">error</span>) <span style="color:#8be9fd">error</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#6272a4">// ä»è¿æ¥æ± è·å–ä¸€ä¸ªæ•°æ®åº“è¿æ¥
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>    dbConn <span style="color:#ff79c6">:=</span> <span style="color:#50fa7b">NewDB</span>()
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">return</span> <span style="color:#50fa7b">fn</span>(dbConn)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>å¦‚ä½ æ‰€è§ï¼Œå®ƒè·å–ä¸€ä¸ªè¿æ¥ï¼Œç„¶åä¼ é€’ç»™æä¾›çš„å‚æ•°ï¼Œå¹¶ä¸”åœ¨è°ƒç”¨å‡½æ•°çš„æ—¶å€™è¿”å›é”™è¯¯ã€‚ä½ éœ€è¦åšçš„åªæ˜¯ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">func</span> <span style="color:#50fa7b">foo</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#50fa7b">withDBContext</span>(<span style="color:#8be9fd;font-style:italic">func</span>(db <span style="color:#ff79c6">*</span>DB) <span style="color:#8be9fd">error</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">// foo ç›¸å…³å·¥ä½œ
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>    })
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">func</span> <span style="color:#50fa7b">bar</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#50fa7b">withDBContext</span>(<span style="color:#8be9fd;font-style:italic">func</span>(db <span style="color:#ff79c6">*</span>DB) <span style="color:#8be9fd">error</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">// bar ç›¸å…³å·¥ä½œ
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>    })
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">func</span> <span style="color:#50fa7b">qux</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#50fa7b">withDBContext</span>(<span style="color:#8be9fd;font-style:italic">func</span>(db <span style="color:#ff79c6">*</span>DB) <span style="color:#8be9fd">error</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#6272a4">// qux ç›¸å…³å·¥ä½œ
</span></span></span><span style="display:flex;"><span><span style="color:#6272a4"></span>    })
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>ä½ åœ¨è€ƒè™‘ä¸€ä¸ªä¸åŒçš„åœºæ™¯ï¼Œä¾‹å¦‚ä½œä¸€äº›é¢„åˆå§‹åŒ–ï¼Ÿæ²¡é—®é¢˜ï¼Œåªéœ€è¦å°†å®ƒä»¬åŠ åˆ°<code>withDBContext</code>å°±å¯ä»¥äº†ã€‚è¿™å¯¹äºæµ‹è¯•ä¹ŸåŒæ ·æœ‰æ•ˆã€‚</p>
<p>è¿™ä¸ªæ–¹æ³•æœ‰ä¸ªç¼ºé™·ï¼Œå®ƒå¢åŠ äº†ç¼©è¿›å¹¶ä¸”æ›´éš¾é˜…è¯»ã€‚å†æ¬¡æç¤ºï¼Œæ°¸è¿œå¯»æ‰¾æœ€ç®€å•çš„è§£å†³æ–¹æ¡ˆã€‚</p>
<h2 id="10-ä¸ºè®¿é—®-map-å¢åŠ -settergetters">10. ä¸ºè®¿é—® map å¢åŠ  setterï¼Œgetters</h2>
<p>å¦‚æœä½ é‡åº¦ä½¿ç”¨ map è¯»å†™æ•°æ®ï¼Œé‚£ä¹ˆå°±ä¸ºå…¶æ·»åŠ  getter å’Œ setter å§ã€‚é€šè¿‡ getter å’Œ setter ä½ å¯ä»¥å°†é€»è¾‘å°åˆ†åˆ«è£…åˆ°å‡½æ•°é‡Œã€‚è¿™é‡Œæœ€å¸¸è§çš„é”™è¯¯å°±æ˜¯å¹¶å‘è®¿é—®ã€‚å¦‚æœä½ åœ¨æŸä¸ª goroutein é‡Œæœ‰è¿™æ ·çš„ä»£ç ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span>m[<span style="color:#f1fa8c">&#34;foo&#34;</span>] = bar
</span></span></code></pre></div><p>è¿˜æœ‰è¿™ä¸ªï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">delete</span>(m, <span style="color:#f1fa8c">&#34;foo&#34;</span>)
</span></span></code></pre></div><p>ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿä½ ä»¬ä¸­çš„å¤§å¤šæ•°åº”å½“å·²ç»éå¸¸ç†Ÿæ‚‰è¿™æ ·çš„ç«æ€äº†ã€‚ç®€å•æ¥è¯´è¿™ä¸ªç«æ€æ˜¯ç”±äº map é»˜è®¤å¹¶éçº¿ç¨‹å®‰å…¨ã€‚ä¸è¿‡ä½ å¯ä»¥ç”¨äº’æ–¥é‡æ¥ä¿æŠ¤å®ƒä»¬ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Go" data-lang="Go"><span style="display:flex;"><span>mu.<span style="color:#50fa7b">Lock</span>()
</span></span><span style="display:flex;"><span>m[<span style="color:#f1fa8c">&#34;foo&#34;</span>] = <span style="color:#f1fa8c">&#34;bar&#34;</span>
</span></span><span style="display:flex;"><span>mu.<span style="color:#50fa7b">Unlock</span>()
</span></span></code></pre></div><p>ä»¥åŠï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span>mu.<span style="color:#50fa7b">Lock</span>()
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">delete</span>(m, <span style="color:#f1fa8c">&#34;foo&#34;</span>)
</span></span><span style="display:flex;"><span>mu.<span style="color:#50fa7b">Unlock</span>()
</span></span></code></pre></div><p>å‡è®¾ä½ åœ¨å…¶ä»–åœ°æ–¹ä¹Ÿä½¿ç”¨è¿™ä¸ª mapã€‚ä½ å¿…é¡»æŠŠäº’æ–¥é‡æ”¾å¾—åˆ°å¤„éƒ½æ˜¯ï¼ç„¶è€Œé€šè¿‡ getter å’Œ setter å‡½æ•°å°±å¯ä»¥å¾ˆå®¹æ˜“çš„é¿å…è¿™ä¸ªé—®é¢˜ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">func</span> <span style="color:#50fa7b">Put</span>(key, value <span style="color:#8be9fd">string</span>) {
</span></span><span style="display:flex;"><span>    mu.<span style="color:#50fa7b">Lock</span>()
</span></span><span style="display:flex;"><span>    m[key] = value
</span></span><span style="display:flex;"><span>    mu.<span style="color:#50fa7b">Unlock</span>()
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">func</span> <span style="color:#50fa7b">Delete</span>(key <span style="color:#8be9fd">string</span>) {
</span></span><span style="display:flex;"><span>    mu.<span style="color:#50fa7b">Lock</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">delete</span>(m, key)
</span></span><span style="display:flex;"><span>    mu.<span style="color:#50fa7b">Unlock</span>()
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>ä½¿ç”¨æ¥å£å¯ä»¥å¯¹è¿™ä¸€è¿‡ç¨‹åšè¿›ä¸€æ­¥çš„æ”¹è¿›ã€‚ä½ å¯ä»¥å°†å®ç°å®Œå…¨éšè—èµ·æ¥ã€‚åªä½¿ç”¨ä¸€ä¸ªç®€å•çš„ã€è®¾è®¡è‰¯å¥½çš„æ¥å£ï¼Œç„¶åè®©åŒ…çš„ç”¨æˆ·ä½¿ç”¨å®ƒä»¬ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">type</span> Storage <span style="color:#8be9fd;font-style:italic">interface</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#50fa7b">Delete</span>(key <span style="color:#8be9fd">string</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#50fa7b">Get</span>(key <span style="color:#8be9fd">string</span>) <span style="color:#8be9fd">string</span>
</span></span><span style="display:flex;"><span>    <span style="color:#50fa7b">Put</span>(key, value <span style="color:#8be9fd">string</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>è¿™åªæ˜¯ä¸ªä¾‹å­ï¼Œä¸è¿‡ä½ åº”è¯¥èƒ½ä½“ä¼šåˆ°ã€‚å¯¹äºåº•å±‚çš„å®ç°ä½¿ç”¨ä»€ä¹ˆéƒ½æ²¡å…³ç³»ã€‚ä¸å…‰æ˜¯ä½¿ç”¨æ¥å£æœ¬èº«å¾ˆç®€å•ï¼Œè€Œä¸”è¿˜è§£å†³äº†æš´éœ²å†…éƒ¨æ•°æ®ç»“æ„å¸¦æ¥çš„å¤§é‡çš„é—®é¢˜ã€‚</p>
<p>ä½†æ˜¯å¾—æ‰¿è®¤ï¼Œæœ‰æ—¶åªæ˜¯ä¸ºäº†åŒæ—¶å¯¹è‹¥å¹²ä¸ªå˜é‡åŠ é”å°±ä½¿ç”¨æ¥å£ä¼šæœ‰äº›è¿‡åˆ†ã€‚ç†è§£ä½ çš„ç¨‹åºï¼Œå¹¶ä¸”åœ¨ä½ éœ€è¦çš„æ—¶å€™ä½¿ç”¨è¿™äº›æ”¹è¿›ã€‚</p>
<h2 id="æ€»ç»“">æ€»ç»“</h2>
<p>æŠ½è±¡æ°¸è¿œéƒ½ä¸æ˜¯å®¹æ˜“çš„äº‹æƒ…ã€‚æœ‰æ—¶ï¼Œæœ€ç®€å•çš„å°±æ˜¯ä½ å·²ç»å®ç°çš„æ–¹æ³•ã€‚è¦çŸ¥é“ï¼Œä¸è¦è®©ä½ çš„ä»£ç çœ‹èµ·æ¥å¾ˆèªæ˜ã€‚Go å¤©ç”Ÿå°±æ˜¯ä¸ªç®€å•çš„è¯­è¨€ï¼Œåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹åªä¼šæœ‰ä¸€ç§æ–¹æ³•æ¥ä½œæŸäº‹ã€‚ç®€å•æ˜¯åŠ›é‡çš„æºæ³‰ï¼Œä¹Ÿæ˜¯ä¸ºä»€ä¹ˆåœ¨äººçš„å±‚é¢å®ƒè¡¨ç°çš„å¦‚æ­¤æœ‰å¼¹æ€§ã€‚</p>
<p>å¦‚æœå¿…è¦çš„è¯ï¼Œä½¿ç”¨è¿™äº›åŸºæ•°ã€‚ä¾‹å¦‚å°†<code>[]Server</code>è½¬åŒ–ä¸º<code>Servers</code>æ˜¯å¦ä¸€ç§æŠ½è±¡ï¼Œä»…åœ¨ä½ æœ‰ä¸€ä¸ªåˆç†çš„ç†ç”±çš„æƒ…å†µä¸‹è¿™ä¹ˆåšã€‚ä¸è¿‡æœ‰ä¸€äº›æŠ€æœ¯ï¼Œå¦‚ iota ä» 1 å¼€å§‹è®¡æ•°æ€»æ˜¯æœ‰ç”¨çš„ã€‚å†æ¬¡æé†’ï¼Œæ°¸è¿œä¿æŒç®€å•ã€‚</p>
<p>ç‰¹åˆ«æ„Ÿè°¢ Cihangir Savasã€Andrew Gerrandã€Ben Johnson å’Œ Damian Gryski æä¾›çš„æå…·ä»·å€¼çš„åé¦ˆå’Œå»ºè®®ã€‚</p>


                
                
<div class="entry-shang text-center">
    
	    <p> ã€Œå¦‚æœè¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰ç”¨,è¯·éšæ„æ‰“èµã€</p>
	
	<button class="zs show-zs btn btn-bred">èµèµæ”¯æŒ</button>
</div>
<div class="zs-modal-bg"></div>
<div class="zs-modal-box">
	<div class="zs-modal-head">
		<button type="button" class="close">Ã—</button>
		<span class="author"><a href="https://jacobc.vercel.app/"><img src="/img/favicon.png" />Jacobc&#39; Blog</a></span>
        
	        <p class="tip"><i></i><span>å¦‚æœè¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰ç”¨,è¯·éšæ„æ‰“èµ</span></p>
		
 
	</div>
	<div class="zs-modal-body">
		<div class="zs-modal-btns">
			<button class="btn btn-blink" data-num="2">2å…ƒ</button>
			<button class="btn btn-blink" data-num="5">5å…ƒ</button>
			<button class="btn btn-blink" data-num="10">10å…ƒ</button>
			<button class="btn btn-blink" data-num="50">50å…ƒ</button>
			<button class="btn btn-blink" data-num="100">100å…ƒ</button>
			<button class="btn btn-blink" data-num="1">ä»»æ„é‡‘é¢</button>
		</div>
		<div class="zs-modal-pay">
			<button class="btn btn-bred" id="pay-text">2å…ƒ</button>
			<p>ä½¿ç”¨<span id="pay-type">å¾®ä¿¡</span>æ‰«æäºŒç»´ç å®Œæˆæ”¯ä»˜</p>
			<img src="/img/reward/wechat-2.png"  id="pay-image"/>
		</div>
	</div>
	<div class="zs-modal-footer">
		<label><input type="radio" name="zs-type" value="wechat" class="zs-type" checked="checked"><span ><span class="zs-wechat"><img src="/img/reward/wechat-btn.png"/></span></label>
		<label><input type="radio" name="zs-type" value="alipay" class="zs-type" class="zs-alipay"><img src="/img/reward/alipay-btn.png"/></span></label>
	</div>
</div>
<script type="text/javascript" src="/js/reward.js"></script>

                

                <hr>
                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/post/v2ray%E4%BD%BF%E7%94%A8/" data-toggle="tooltip" data-placement="top" title="Mac ä½¿ç”¨ V2ray">&larr;
                            Previous Post</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/post/db/cockroachdb/" data-toggle="tooltip" data-placement="top" title="åˆæ¢ Cockroachdb">Next
                            Post &rarr;</a>
                    </li>
                    
                </ul>
                
            </div>

            
            
            <div class="
                col-lg-2 col-lg-offset-0
                visible-lg-block
                sidebar-container
                catalog-container">
                <div class="side-catalog">
                    <hr class="hidden-sm hidden-xs">
                    <h5>
                        <a class="catalog-toggle" href="#">CATALOG</a>
                    </h5>
                    <ul class="catalog-body"></ul>
                </div>
            </div>
            

            
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                
                
                <section>
                    <hr class="hidden-sm hidden-xs">
                    <h5><a href="/tags/">FEATURED TAGS</a></h5>
                    <div class="tags">
                        
                        
                        
                        <a href="/tags/android" title="android">
                            android
                        </a>
                        
                        
                        
                        <a href="/tags/biz" title="biz">
                            biz
                        </a>
                        
                        
                        
                        <a href="/tags/centos" title="centos">
                            centos
                        </a>
                        
                        
                        
                        <a href="/tags/centos7" title="centos7">
                            centos7
                        </a>
                        
                        
                        
                        <a href="/tags/charles" title="charles">
                            charles
                        </a>
                        
                        
                        
                        <a href="/tags/cobra" title="cobra">
                            cobra
                        </a>
                        
                        
                        
                        <a href="/tags/cockroach" title="cockroach">
                            cockroach
                        </a>
                        
                        
                        
                        <a href="/tags/docker" title="docker">
                            docker
                        </a>
                        
                        
                        
                        <a href="/tags/flutter" title="flutter">
                            flutter
                        </a>
                        
                        
                        
                        <a href="/tags/git" title="git">
                            git
                        </a>
                        
                        
                        
                        <a href="/tags/gitea" title="gitea">
                            gitea
                        </a>
                        
                        
                        
                        <a href="/tags/glibc" title="glibc">
                            glibc
                        </a>
                        
                        
                        
                        <a href="/tags/golang" title="golang">
                            golang
                        </a>
                        
                        
                        
                        <a href="/tags/jenkins" title="jenkins">
                            jenkins
                        </a>
                        
                        
                        
                        <a href="/tags/k8s" title="k8s">
                            k8s
                        </a>
                        
                        
                        
                        <a href="/tags/linux" title="linux">
                            linux
                        </a>
                        
                        
                        
                        <a href="/tags/mac" title="mac">
                            mac
                        </a>
                        
                        
                        
                        <a href="/tags/mindoc" title="mindoc">
                            mindoc
                        </a>
                        
                        
                        
                        <a href="/tags/mongo" title="mongo">
                            mongo
                        </a>
                        
                        
                        
                        <a href="/tags/mysql" title="mysql">
                            mysql
                        </a>
                        
                        
                        
                        <a href="/tags/oh-my-zsh" title="oh-my-zsh">
                            oh-my-zsh
                        </a>
                        
                        
                        
                        <a href="/tags/react" title="react">
                            react
                        </a>
                        
                        
                        
                        <a href="/tags/ssh" title="ssh">
                            ssh
                        </a>
                        
                        
                        
                        <a href="/tags/termux" title="termux">
                            termux
                        </a>
                        
                        
                        
                        <a href="/tags/%E5%90%8E%E7%AB%AF" title="åç«¯">
                            åç«¯
                        </a>
                        
                        
                        
                        <a href="/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8" title="æœåŠ¡å™¨">
                            æœåŠ¡å™¨
                        </a>
                        
                        
                        
                        <a href="/tags/%E7%8E%AF%E5%A2%83" title="ç¯å¢ƒ">
                            ç¯å¢ƒ
                        </a>
                        
                        
                        
                        <a href="/tags/%E7%BA%BF%E7%A8%8B" title="çº¿ç¨‹">
                            çº¿ç¨‹
                        </a>
                        
                        
                        
                        <a href="/tags/%E8%BD%AF%E4%BB%B6" title="è½¯ä»¶">
                            è½¯ä»¶
                        </a>
                        
                        
                        
                        <a href="/tags/%E8%BF%9B%E7%A8%8B" title="è¿›ç¨‹">
                            è¿›ç¨‹
                        </a>
                        
                        
                    </div>
                </section>
                

                
                
                <section>
                    <hr>
                    <h5>FRIENDS</h5>
                    <ul class="list-inline">
                        
                        <li><a target="_blank" href="https://hugo-pages.vercel.app">cengchengjieçš„åšå®¢</a></li>
                        
                    </ul>
                </section>
                
            </div>
        </div>
    </div>
</article>




<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">                  
                    
                    <li>
                        <a href="mailto:liu666888@111.com">
                            <span class="fa-stack fa-lg">
                                <i class="fas fa-circle fa-stack-2x"></i>
                                <i class="fas fa-envelope fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
		           
                    
                    
                    
                    

		            
                    
                    <li>
                        <a target="_blank" href="/liu1773867204">
                            <span class="fa-stack fa-lg">
                                <i class="fas fa-circle fa-stack-2x"></i>
                                <i class="fab fa-weixin fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
		            
                    
                    <li>
                        <a target="_blank" href="https://github.com/Jsharkc">
                            <span class="fa-stack fa-lg">
                                <i class="fas fa-circle fa-stack-2x"></i>
                                <i class="fab fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
		            
                    
                    
                    
                    
                    
                    
                    
                    
                    
            
            
            
           
                   <li>
                       <a href='' rel="alternate" type="application/rss+xml" title="Jacobc&#39; Blog" >
                           <span class="fa-stack fa-lg">
                               <i class="fas fa-circle fa-stack-2x"></i>
                               <i class="fas fa-rss fa-stack-1x fa-inverse"></i>
                           </span>
                       </a>
                   </li>
            
             </ul>
		<p class="copyright text-muted">
                    Copyright &copy; Jacobc&#39; Blog 2025
                    <br>
                    <a href="https://themes.gohugo.io/hugo-theme-cleanwhite">CleanWhite Hugo Theme</a> by <a href="https://zhaohuabing.com">Huabing</a> |
                    <iframe
                        style="margin-left: 2px; margin-bottom:-5px;"
                        frameborder="0" scrolling="0" width="100px" height="20px"
                        src="https://ghbtns.com/github-btn.html?user=zhaohuabing&repo=hugo-theme-cleanwhite&type=star&count=true" >
                    </iframe>
                </p>
            </div>
        </div>
    </div>
</footer>




<script>
    function loadAsync(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>






<script>
    
    if($('#tag_cloud').length !== 0){
        loadAsync("/js/jquery.tagcloud.js",function(){
            $.fn.tagcloud.defaults = {
                
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>


<script>
    loadAsync("https://cdn.jsdelivr.net/npm/fastclick@1.0.6/lib/fastclick.min.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>









<script type="text/javascript">
    function generateCatalog(selector) {

        
        
        
        
            _containerSelector = 'div.post-container'
        

        
        var P = $(_containerSelector), a, n, t, l, i, c;
        a = P.find('h1,h2,h3,h4,h5,h6');

        
        $(selector).html('')

        
        a.each(function () {
            n = $(this).prop('tagName').toLowerCase();
            i = "#" + $(this).prop('id');
            t = $(this).text();
            c = $('<a href="' + i + '" rel="nofollow">' + t + '</a>');
            l = $('<li class="' + n + '_nav"></li>').append(c);
            $(selector).append(l);
        });
        return true;
    }

    generateCatalog(".catalog-body");

    
    $(".catalog-toggle").click((function (e) {
        e.preventDefault();
        $('.side-catalog').toggleClass("fold")
    }))

    


    loadAsync("\/js\/jquery.nav.js", function () {
        $('.catalog-body').onePageNav({
            currentClass: "active",
            changeHash: !1,
            easing: "swing",
            filter: "",
            scrollSpeed: 700,
            scrollOffset: 0,
            scrollThreshold: .2,
            begin: null,
            end: null,
            scrollChange: null,
            padding: 80
        });
    });
</script>


</body>
</html>
